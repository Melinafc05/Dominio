<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Resolución de Desigualdades</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: 30px auto;
      background-color: #f0f0f0;
      padding: 20px;
      border-radius: 10px;
    }

    input, button {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      margin-top: 10px;
    }

    #resultado {
      background-color: white;
      padding: 15px;
      margin-top: 20px;
      border-radius: 8px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>

<h2>Resolver Desigualdades Lineales y Cuadráticas</h2>
<p>Ejemplos: <code>x^2 + 2x - 3 > 0</code> o <code>2x - 4 &lt;= 0</code></p>

<input type="text" id="desigualdad" placeholder="Ingresa la desigualdad aquí">
<button onclick="resolver()">Resolver</button>

<div id="resultado"></div>

<!-- Cargar math.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.11.0/math.js"></script>

<script>
function resolver() {
  const input = document.getElementById("desigualdad").value.replace(/\s/g, '');
  const resultado = document.getElementById("resultado");

  const match = input.match(/^(.+)([<>]=?|>=|<=)(.+)$/);
  if (!match) {
    resultado.innerHTML = "⚠️ Formato inválido. Usa expresiones como x^2+2x-3>0";
    return;
  }

  const izquierda = match[1];
  const operador = match[2];
  const derecha = match[3];

  // Simplificamos la desigualdad a forma: f(x) > 0
  const expr = `${izquierda}-(${derecha})`;
  let f;
  try {
    f = math.simplify(expr);
  } catch (err) {
    resultado.innerHTML = "❌ Error en la expresión: " + err.message;
    return;
  }

  // Obtenemos coeficientes del polinomio
  const exprStr = f.toString();
  let coef;
  try {
    coef = math.polyCoefficients(math.parse(exprStr), 'x');
  } catch {
    resultado.innerHTML = "❌ Solo se admiten expresiones polinómicas en x.";
    return;
  }

  if (coef.length === 2) {
    resolverLineal(coef, operador, resultado);
  } else if (coef.length === 3) {
    resolverCuadratica(coef, operador, resultado);
  } else {
    resultado.innerHTML = "❌ Solo se admiten polinomios de grado 1 o 2.";
  }
}

function resolverLineal([m, b], op, div) {
  if (m === 0) {
    div.innerHTML = b + interpretacionConstante(op);
    return;
  }

  const x = -b / m;
  let sol = "";

  if (op === ">") sol = (m > 0) ? `x > ${x}` : `x < ${x}`;
  if (op === ">=") sol = (m > 0) ? `x ≥ ${x}` : `x ≤ ${x}`;
  if (op === "<") sol = (m > 0) ? `x < ${x}` : `x > ${x}`;
  if (op === "<=") sol = (m > 0) ? `x ≤ ${x}` : `x ≥ ${x}`;

  div.innerHTML = `<strong>Solución:</strong> ${sol}`;
}

function resolverCuadratica([a, b, c], op, div) {
  const D = b*b - 4*a*c;

  if (D < 0) {
    const cumple = (a > 0 && (op === ">" || op === ">=")) || (a < 0 && (op === "<" || op === "<="));
    div.innerHTML = cumple ? "La desigualdad se cumple para todos los x reales." : "No hay solución real.";
    return;
  }

  const x1 = (-b - Math.sqrt(D)) / (2*a);
  const x2 = (-b + Math.sqrt(D)) / (2*a);
  const [r1, r2] = [x1, x2].sort((a, b) => a - b);

  let sol = "";

  if (a > 0) {
    if (op === ">") sol = `x < ${r1.toFixed(2)} o x > ${r2.toFixed(2)}`;
    if (op === ">=") sol = `x ≤ ${r1.toFixed(2)} o x ≥ ${r2.toFixed(2)}`;
    if (op === "<") sol = `x ∈ (${r1.toFixed(2)}, ${r2.toFixed(2)})`;
    if (op === "<=") sol = `x ∈ [${r1.toFixed(2)}, ${r2.toFixed(2)}]`;
  } else {
    if (op === ">") sol = `x ∈ (${r1.toFixed(2)}, ${r2.toFixed(2)})`;
    if (op === ">=") sol = `x ∈ [${r1.toFixed(2)}, ${r2.toFixed(2)}]`;
    if (op === "<") sol = `x < ${r1.toFixed(2)} o x > ${r2.toFixed(2)}`;
    if (op === "<=") sol = `x ≤ ${r1.toFixed(2)} o x ≥ ${r2.toFixed(2)}`;
  }

  div.innerHTML = `<strong>Raíces:</strong> x₁ = ${r1.toFixed(2)}, x₂ = ${r2.toFixed(2)}<br><strong>Solución:</strong> ${sol}`;
}

function interpretacionConstante(op) {
  if (op === ">") return (0 > 0) ? " → Siempre verdadera" : " → Falsa para todo x";
  if (op === ">=") return (0 >= 0) ? " → Verdadera para todo x" : " → Falsa para todo x";
  if (op === "<") return (0 < 0) ? " → Siempre verdadera" : " → Falsa para todo x";
  if (op === "<=") return (0 <= 0) ? " → Verdadera para todo x" : " → Falsa para todo x";
}
</script>

</body>
</html>

